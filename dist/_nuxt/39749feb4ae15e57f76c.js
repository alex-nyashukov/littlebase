(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{583:function(e,t,r){"use strict";r.r(t);r(7),r(6),r(78),r(59);var n,o=r(19),l=r(569),c=r.n(l),d=(r(38),r(20)),f=r(21),m=r(570),v=r.n(m),h=r(175),x=(r(176),function(){function e(){Object(d.a)(this,e)}var t;return Object(f.a)(e,null,[{key:"render",value:(t=Object(o.a)(regeneratorRuntime.mark((function e(t){var r,template,n,o,l,c,d,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.drivers,template=t.template,n=t.month,o=new v.a.Workbook,e.next=4,o.xlsx.load(template);case 4:return(l=o.getWorksheet("main")).getRow(1).getCell(1).value='Администрация Филиала "Юго-Западный", в лице директора  Р.А. Езохова, предлагает нижеперечисленным водителям 13-ой автоколонны выполнять сверхурочную работу за пределами установленной продолжительности рабочего времени (баланса), а так же работу в выходные, праздничные дни в '.concat(n," месяце 2019  года."),c=3,d=0,f=0,r.forEach((function(e){d=2+4*f,l.getRow(c).getCell(d).value=e.tabnumber,d=3+4*f,l.getRow(c).getCell(d).value=e.shortName,51==++c&&(c=3,f++)})),e.next=12,o.xlsx.writeBuffer();case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}()),w=function(){function e(){Object(d.a)(this,e)}var t;return Object(f.a)(e,null,[{key:"render",value:(t=Object(o.a)(regeneratorRuntime.mark((function e(t){var r,template,n,o,l,c,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.drivers,template=t.template,n=new v.a.Workbook,e.next=4,n.xlsx.load(template);case 4:return o=n.getWorksheet("main"),c=10,r.forEach((function(e){l=o.getRow(c),d=3,l.getCell(d).value=e.name,d=6,l.getCell(d).value=e.tabnumber,d=10,new h.a(e).statusesByDate("2019-09-01",30,!0).forEach((function(e){l.getCell(d).value=e,d++})),c++})),e.next=9,n.xlsx.writeBuffer();case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),k=function(){function e(){Object(d.a)(this,e)}var t;return Object(f.a)(e,null,[{key:"render",value:(t=Object(o.a)(regeneratorRuntime.mark((function e(t){var r,template,n,o,l,i,c,d,f,m,x,w,k,R,C;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C=function(e,t,r,n){var o=r,l=n;if(t.busnumber){e.getRow(o).getCell(l).value=t.busnumber;var c=[];switch(t.drivers.length){case 1:c=[4];break;case 2:c=[2,6];break;case 3:c=[1,4,7];break;case 4:c=[1,3,5,7]}t.drivers.forEach((function(t,r){var n=new h.a(t);e.getRow(o+c[r]).getCell(l+1).value=n.shortName,e.getRow(o+c[r]).getCell(l+2).value=n.tabnumber}))}},R=function(e,t){},k=function(e,t){var r=9;t.forEach((function(t){C(e,t,r,2),r+=8}))},r=t.buses,template=t.template,n=new v.a.Workbook,e.next=7,n.xlsx.load(template);case 7:for((o=Math.ceil(r.length/4))%2==0&&o++,l=[],i=0;i<o;i++)for(l.push([]),c=0;c<4;c++)l[i].push(r[4*i+c]||{});for(l.unshift([{},{},{},{}]),d=l.length,f=n.getWorksheet("Page 1"),m=1;m<d;m++)(x=n.addWorksheet("Sheet")).model=Object.assign(f.model,{mergeCells:f.model.merges}),x.name="Page "+(1+m);for(w=0;w<d/2;w++)f=n.getWorksheet("Page "+(2*w+1)),k(f,l[w+1]),R(f,l[d-(w+1)]),f=n.getWorksheet("Page "+(2*w+2)),k(f,l[(d-w)%d]),R(f,l[w]);return e.next=18,n.xlsx.writeBuffer();case 18:return e.abrupt("return",e.sent);case 19:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),R={transition:"fade",data:function(){var e,t,r,n=this;return{downloads:[{title:"А3",month:"Январь",renderer:k,code:"a3",getData:(r=Object(o.a)(regeneratorRuntime.mark((function e(){var t,template;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.$store.dispatch("buses/readAll"),n.$store.dispatch("templates/download",{filename:"a3.xlsx"})]);case 2:return t=n.$store.getters["buses/list"],template=n.$store.getters["templates/template"]("a3.xlsx"),e.abrupt("return",{buses:t,template:template});case 5:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{title:"А4",month:"Январь",renderer:w,code:"a4",getData:(t=Object(o.a)(regeneratorRuntime.mark((function e(){var t,template;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.$store.dispatch("drivers/readAll"),n.$store.dispatch("templates/download",{filename:"a4.xlsx"})]);case 2:return t=n.$store.getters["drivers/list"],template=n.$store.getters["templates/template"]("a4.xlsx"),e.abrupt("return",{drivers:t,template:template});case 5:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{title:"Согласие",month:"Январь",renderer:x,code:"agreement",getData:(e=Object(o.a)(regeneratorRuntime.mark((function e(){var t,template;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.$store.dispatch("drivers/readAll"),n.$store.dispatch("templates/download",{filename:"agreement.xlsx"})]);case 2:return t=n.$store.getters["drivers/list"],template=n.$store.getters["templates/template"]("agreement.xlsx"),e.abrupt("return",{drivers:t,template:template});case 5:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)})}],items:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"]}},methods:{get_file:(n=Object(o.a)(regeneratorRuntime.mark((function e(t){var data,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getData();case 2:return(data=e.sent).month=t.month,e.next=6,t.renderer.render(data);case 6:r=e.sent,c()(new Blob([r]),t.code+".xlsx");case 8:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}},C=r(24),y=r(28),_=r.n(y),j=r(104),O=r(550),$=r(549),V=r(580),W=r(539),P=r(128),B=r(541),E=r(521),component=Object(C.a)(R,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-layout",{attrs:{row:""}},e._l(e.downloads,(function(t,n){return r("v-flex",{key:n,staticClass:"pa-3",attrs:{xs12:"",sm6:"",md4:""}},[r("v-card",[r("v-card-title",{staticClass:"green"},[r("v-icon",{attrs:{dark:""}},[e._v("fa-file-excel")]),e._v(" "),r("span",{staticClass:"ml-3 white--text"},[e._v(e._s(t.title))])],1),e._v(" "),r("v-card-text",{staticClass:"pt-2"},[r("v-select",{attrs:{items:e.items,label:"Месяц"},model:{value:t.month,callback:function(r){e.$set(t,"month",r)},expression:"download.month"}}),e._v(" "),r("v-file-input",{attrs:{label:"Шаблон"}}),e._v(" "),r("v-layout",{attrs:{row:"","justify-space-between":""}},[r("v-flex",[r("v-btn",{attrs:{rounded:"",color:"green",dark:""}},[e._v("Загрузить")])],1),e._v(" "),r("v-flex",[r("v-btn",{attrs:{rounded:"",color:"green",dark:""}},[e._v("Скачать ")])],1)],1)],1),e._v(" "),r("v-card-actions",{staticClass:"pa-0"},[r("v-btn",{staticStyle:{"font-size":"1.4rem","border-top-left-radius":"0","border-top-right-radius":"0"},attrs:{height:"52",block:"",color:"green",dark:""},on:{click:function(r){return e.get_file(t)}}},[e._v("\r\n          Скачать\r\n        ")])],1)],1)],1)})),1)}),[],!1,null,null,null);t.default=component.exports;_()(component,{VBtn:j.a,VCard:O.a,VCardActions:$.a,VCardText:$.b,VCardTitle:$.c,VFileInput:V.a,VFlex:W.a,VIcon:P.a,VLayout:B.a,VSelect:E.a})}}]);