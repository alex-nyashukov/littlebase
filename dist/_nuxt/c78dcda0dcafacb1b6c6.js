(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{566:function(e,t,n){"use strict";var r=n(2),o=n.n(r),l={props:["value"],data:function(){return{menu:!1}},computed:{formattedDate:function(){return this.value?o()(this.value).format("DD/MM/YYYY"):""}},methods:{changeDate:function(e){this.$emit("input",e),this.menu=!1},nextDay:function(){this.$emit("input",o()(this.value).add(1,"d").format("YYYY-MM-DD"))},prevDay:function(){this.$emit("input",o()(this.value).subtract(1,"d").format("YYYY-MM-DD"))}}},c=n(23),d=n(26),v=n.n(d),f=n(557),m=n(175),h=n(76),component=Object(c.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-menu",{attrs:{"close-on-content-click":!1,"max-width":"290"},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[n("v-text-field",e._g({staticClass:"desable-shadow mr-4",staticStyle:{"box-shadow":"none"},attrs:{flat:"",solo:"","hide-details":"",value:e.formattedDate,label:"Date",readonly:""}},r))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[e._v(" "),n("v-date-picker",{attrs:{value:e.value,"no-title":""},on:{change:e.changeDate}})],1)}),[],!1,null,null,null);t.a=component.exports;v()(component,{VDatePicker:f.a,VMenu:m.a,VTextField:h.a})},577:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));n(25),n(27);var r=n(20),o=n(181),l=function e(t,n){var l=this;Object(r.a)(this,e),this.errors=[],this.workTable=[],this.driverReserveCount=0,this.driverReserveTable=[],this.busReserve=[],this.outDrivers={"Выходной":[],"Больничный":[],"Отпуск":[]},this.outBuses={"Ремонт":[],"СВАРЗ":[]},n.forEach((function(e){var n={"Рабочий":[],"Первая см.":[],"Вторая см.":[]},r=0;e.drivers.forEach((function(e){var c=(e=new o.a(e)).statusesByDate({date:t,count:1,isShort:!1,withExceptions:!0})[0].status;c?["Рабочий","Первая см.","Вторая см."].includes(c)?(r++,n[c].push(e)):l.outDrivers[c].push(e):l.errors.push("У водителя ".concat(e.tabnumber," нет статуса"))})),["Ремонт","СВАРЗ","Долгостой"].includes(e.status)?("Долгостой"==e.status?l.outBuses["Ремонт"].push(e):l.outBuses[e.status].push(e),0!==r&&(l.driverReserveCount+=r,n["Автобус"]=Object.assign({},e),n["Автобус"].busnumber+=" ".concat(e.status),l.driverReserveTable.push(n))):0===r?l.busReserve.push(e):(n["Автобус"]=e,l.workTable.push(n))})),this.workTable=this.workTable.concat(this.busReserve.map((function(e){return{"Автобус":e,"Первая см.":[],"Вторая см.":[],"Рабочий":[]}}))),this.workTable=this.workTable.concat(this.driverReserveTable)}},614:function(e,t,n){"use strict";n.r(t);n(7),n(6),n(46),n(50);var r=n(18),o=n(2),l=n.n(o),c=n(569),d=n.n(c),v={props:["title","loading"]},f=n(23),m=n(26),h=n.n(m),w=n(107),x=n(563),R=n(562),k=n(136),component=Object(f.a)(v,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",[n("v-card-title",{staticClass:"green"},[n("v-icon",{attrs:{dark:""}},[e._v("fa-file-excel")]),e._v(" "),n("span",{staticClass:"ml-3 white--text"},[e._v(e._s(e.title))])],1),e._v(" "),n("v-card-text",{staticClass:"pt-2"},[e._t("default")],2),e._v(" "),n("v-card-actions",{staticClass:"pa-0"},[n("v-btn",{staticStyle:{"font-size":"1.4rem","border-top-left-radius":"0","border-top-right-radius":"0"},attrs:{loading:e.loading,height:"52",block:"",color:"green",dark:""},on:{click:function(t){return e.$emit("download")}}},[n("span",[e._v("Скачать")])])],1)],1)}),[],!1,null,null,null),C=component.exports;h()(component,{VBtn:w.a,VCard:x.a,VCardActions:R.a,VCardText:R.b,VCardTitle:R.c,VIcon:k.a});var y,_,D=n(566),O=n(20),j=n(21),M=n(570),$=n.n(M),Y=n(577),L=function(){function e(){Object(O.a)(this,e)}var t;return Object(j.a)(e,null,[{key:"render",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,r,o,l,c,i,d,v,f,m,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(h=function(e,t,n,r){var o=n,l=r;e.getRow(o).getCell(l).value="Рабочие",f++;var c=d(e,t.workTable.sort((function(a,b){return a["Автобус"].busnumber-b["Автобус"].busnumber})).slice(0,Math.ceil(t.workTable.length/2)),o,l);return d(e,t.workTable.sort((function(a,b){return a["Автобус"].busnumber-b["Автобус"].busnumber})).slice(Math.ceil(t.workTable.length/2)),o,l+6),c;function d(e,t,n,r){return f=n,l=r,f++,e.getRow(f).getCell(l).value="Автобус",e.getRow(f).getCell(l+2).value="Первая",e.getRow(f).getCell(l+3).value="Вторая",e.getRow(f).getCell(l+4).value="Полный",v=++f,t.forEach((function(t,n){f=v+n,e.getRow(f).getCell(l).value=t["Автобус"].busnumber,e.getRow(f).getCell(l+2).value=t["Первая см."].map((function(e){return e.tabnumber})).join(", "),e.getRow(f).getCell(l+3).value=t["Вторая см."].map((function(e){return e.tabnumber})).join(", "),e.getRow(f).getCell(l+4).value=t["Рабочий"].map((function(e){return e.tabnumber})).join(", ");for(var r=0;r<5;r++)e.getRow(f).getCell(l+r).border={top:{style:"thin"}}})),f}},m=function(e,t,n,r){var o=n,l=0,c=r;for(var d in e.getRow(o).getCell(c).value="Автобусы",e.getRow(o+1).getCell(c).value="Резерв (".concat(t.busReserve.length,")"),l=o+=2,t.busReserve.sort((function(a,b){return a.busnumber-b.busnumber})).forEach((function(t,n){l=o+Math.floor(n/5),e.getRow(l).getCell(c+n%5).value=t.busnumber})),l+=2,t.outBuses)e.getRow(l).getCell(c).value="".concat(d," (").concat(t.outBuses[d].length,")"),o=++l,t.outBuses[d].sort((function(a,b){return a.busnumber-b.busnumber})).forEach((function(t,n){l=o+Math.floor(n/5),e.getRow(l).getCell(c+n%5).value=t.busnumber})),l+=2;for(var v in o=n,c+=5,e.getRow(o).getCell(c).value="Водители",e.getRow(o+1).getCell(c).value="Резерв (".concat(t.driverReserveCount,")"),l=o+=2,e.getRow(o).getCell(c).value="Первая см.",e.getRow(o).getCell(c+2).value="Вторая см.",e.getRow(o).getCell(c+4).value="Полный день",o=++l,t.driverReserveTable.forEach((function(t,n){l=o+n,e.getRow(l).getCell(c).value=t["Первая см."].map((function(e){return e.tabnumber})).join(", "),e.getRow(l).getCell(c+2).value=t["Вторая см."].map((function(e){return e.tabnumber})).join(", "),e.getRow(l).getCell(c+4).value=t["Рабочий"].map((function(e){return e.tabnumber})).join(", ");for(var r=0;r<6;r++)e.getRow(l).getCell(c+r).border={top:{style:"thin"}}})),o=l+=2,t.outDrivers)e.getRow(l).getCell(c).value="".concat(v," (").concat(t.outDrivers[v].length,")"),o=++l,t.outDrivers[v].sort((function(a,b){return a.tabnumber-b.tabnumber})).forEach((function(t,n){l=o+Math.floor(n/6),e.getRow(l).getCell(c+n%6).value=t.tabnumber})),l+=2;return l},n=t.buses,r=t.date,o=new $.a.Workbook,l=o.addWorksheet("Main"),c=new Y.a(r,n),i=0;i<11;i++)(d=l.getColumn(i+1)).width=11,d.style={font:{size:14}};return v=1,f=h(l,c,1,1),m(l,c,f+=2,1),e.next=14,o.xlsx.writeBuffer();case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),V={components:{AppDownload:C,MenuDatePicker:D.a},data:function(){return{date:l()().format("YYYY-MM-DD"),isLoading:!1,renderer:L}},computed:{buses:function(){return this.$store.getters["buses/list"]}},methods:{get_file:(y=Object(r.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoading=!0,e.next=3,Promise.all([this.$store.dispatch("buses/readAll")]);case 3:return e.next=5,this.renderer.render({buses:this.buses,date:this.date});case 5:t=e.sent,d()(new Blob([t]),"Отчет за ".concat(l()(this.date).format("DD-MM-YY"),".xlsx")),this.isLoading=!1;case 8:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})}},P=Object(f.a)(V,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("app-download",{attrs:{title:"Отчет",loading:e.isLoading},on:{download:e.get_file}},[n("menu-date-picker",{model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1)}),[],!1,null,null,null).exports,S=(n(62),n(39),n(80),n(181)),A=function(){function e(){Object(O.a)(this,e)}var t;return Object(j.a)(e,null,[{key:"render",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,template,r,o,c,d,v,i,f,m,h,w,x,R,k,C;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(C=function(e,t,n,c){var d=n,v=c;e.getRow(d).getCell(v).value=t.busnumber;var f=[];switch(t.drivers.length){case 1:f=[4];break;case 2:f=[2,6];break;case 3:f=[1,4,7];break;case 4:f=[1,3,5,7]}t.drivers.forEach((function(t,n){if(t.tabnumber){var c=new S.a(t);!function(e,t,n,c){var d=n,v=c;e.getRow(d).getCell(v+3).value=t.shortName,e.getRow(d).getCell(v+4).value=t.tabnumber,e.getRow(d).getCell(v+5).value=t.graphicName;for(var f=l()("".concat(o,"-").concat(r),"YYYY-MM").daysInMonth(),m=t.statusesByDate({date:"".concat(o,"-").concat(r,"-01"),count:f,isShort:!0}),h=0;h<f;h++)e.getRow(d).getCell(v+8+h).value=m[h]}(e,c,d+f[n],v)}})),t.way&&(e.getRow(d).getCell(41).value="Выход: ".concat(t.way.route.title,"/").concat(t.way.title),e.getRow(d+2).getCell(41).value="1 смена: ".concat(t.way.times.durationFirstSmene||""),e.getRow(d+2).getCell(44).value="2 смена: ".concat(t.way.times.durationSecondSmene||""),e.getRow(d+3).getCell(41).value="Выезд из парка: ".concat(t.way.times.outPark||""),e.getRow(d+4).getCell(41).value="Время смены: ".concat(t.way.times.change||""),e.getRow(d+5).getCell(41).value="Окончание работы: ".concat(t.way.times.endWork||""),e.getRow(d+7).getCell(41).value="1 смена: ".concat(t.way.times.lunchFirstSmene||""),e.getRow(d+7).getCell(44).value="2 смена: ".concat(t.way.times.lunchSecondSmene||""))},n=t.buses,template=t.template,r=t.month,o="2019",c=(c=Array.from(n)).sort((function(a,b){return a.busnumber-b.busnumber})),d=Math.ceil(c.length/5),v=[],i=0;i<d;i++)for(v.push([]),f=0;f<5;f++)v[i].push(c[5*i+f]||{});return m=new $.a.Workbook,e.next=11,m.xlsx.load(template);case 11:for(h=m.getWorksheet("Page 1"),w=1;w<v.length;w++)(x=m.addWorksheet("Sheet")).model=Object.assign(h.model,{mergeCells:h.model.merges}),x.name="Page "+(1+w);for(R=function(e){(h=m.getWorksheet("Page "+(e+1))).getRow(1).getCell(44).value=e+1,v[e].forEach((function(e,t){e.busnumber&&C(h,e,10+8*t,2)}))},k=0;k<v.length;k++)R(k);return e.next=17,m.xlsx.writeBuffer();case 17:return e.abrupt("return",e.sent);case 18:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),E={components:{AppDownload:C,MenuDatePicker:D.a},data:function(){return{file:null,isLoading:!1,renderer:A,month:"01",items:[{text:"Январь",value:"01"},{text:"Февраль",value:"02"},{text:"Март",value:"03"},{text:"Апрель",value:"04"},{text:"Май",value:"05"},{text:"Июнь",value:"06"},{text:"Июль",value:"07"},{text:"Август",value:"08"},{text:"Сентябрь",value:"09"},{text:"Октябрь",value:"10"},{text:"Ноябрь",value:"11"},{text:"Декабрь",value:"12"}]}},computed:{buses:function(){return this.$store.getters["buses/list"]},template:function(){return this.$store.getters["templates/template"]("templates/a4.xlsx")}},methods:{get_file:function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n,r=this,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]&&o[0],this.isLoading=!0,e.next=4,Promise.all([this.$store.dispatch("buses/readAll"),this.$store.dispatch("templates/download",{filename:"templates/a4.xlsx"})]);case 4:if(n=null,!t){e.next=9;break}n=this.template,e.next=12;break;case 9:return e.next=11,this.renderer.render({buses:this.buses,template:this.template,month:this.month});case 11:n=e.sent;case 12:d()(new Blob([n]),"Журнал A4 на ".concat(this.items.find((function(e){return e.value==r.month})).text,".xlsx")),this.isLoading=!1;case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),onFileChange:function(e){this.file=e},uploadFile:(_=Object(r.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoading=!0,(t=new FormData).append("template",this.file),e.next=5,this.$axios.post("/api/templates/a4.xlsx",t,{headers:{enctype:"multipart/form-data"}});case 5:e.sent.data,this.isLoading=!1;case 8:case"end":return e.stop()}}),e,this)}))),function(){return _.apply(this,arguments)})}},B=n(553),F=n(612),W=n(552),T=n(554),I=n(532),N=Object(f.a)(E,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("app-download",{attrs:{title:"A4",loading:e.isLoading},on:{download:e.get_file}},[n("v-select",{attrs:{items:e.items,label:"Месяц"},model:{value:e.month,callback:function(t){e.month=t},expression:"month"}}),e._v(" "),n("v-file-input",{attrs:{label:"Шаблон"},on:{change:e.onFileChange}}),e._v(" "),n("v-layout",[n("v-row",[n("v-col",{staticClass:"text-center",attrs:{cols:"12",md:"6"}},[n("v-btn",{attrs:{rounded:"",color:"green",dark:""},on:{click:e.uploadFile}},[e._v("Загрузить")])],1),e._v(" "),n("v-col",{staticClass:"text-center",attrs:{cols:"12",md:"6"}},[n("v-btn",{attrs:{rounded:"",color:"green",dark:""},on:{click:function(t){return e.get_file(!0)}}},[e._v("Скачать")])],1)],1)],1)],1)}),[],!1,null,null,null),z=N.exports;h()(N,{VBtn:w.a,VCol:B.a,VFileInput:F.a,VLayout:W.a,VRow:T.a,VSelect:I.a});var J=function(){function e(){Object(O.a)(this,e)}var t;return Object(j.a)(e,null,[{key:"render",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,template,r,o,c,d,v,f,i,m,h,w,x,R,k,C,y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y=function(e,t){var n=9;t.forEach((function(t){!function(e,t,n,c){var d=n,v=c;if(t.busnumber){var f=[];switch(t.drivers.length){case 1:f=[4];break;case 2:f=[2,6];break;case 3:f=[1,4,7];break;case 4:f=[1,3,5,7]}t.drivers.forEach((function(t,n){for(var c=new S.a(t),m=l()("".concat(o,"-").concat(r),"YYYY-MM").daysInMonth(),h=c.statusesByDate({date:"".concat(o,"-").concat(r,"-13"),count:m-12,isShort:!0}),w=0;w<m-12;w++)e.getRow(d+f[n]).getCell(v+w).value=h[w]})),t.way&&(e.getRow(d).getCell(v+19).value="Выход: ".concat(t.way.route.title,"/").concat(t.way.title),e.getRow(d+2).getCell(v+19).value="1 смена: ".concat(t.way.times.durationFirstSmene||""),e.getRow(d+2).getCell(v+22).value="2 смена: ".concat(t.way.times.durationSecondSmene||""),e.getRow(d+3).getCell(v+19).value="Выезд из парка: ".concat(t.way.times.outPark||""),e.getRow(d+4).getCell(v+19).value="Время смены: ".concat(t.way.times.change||""),e.getRow(d+5).getCell(v+19).value="Окончание работы: ".concat(t.way.times.endWork||""),e.getRow(d+7).getCell(v+19).value="1 смена: ".concat(t.way.times.lunchFirstSmene||""),e.getRow(d+7).getCell(v+22).value="2 смена: ".concat(t.way.times.lunchSecondSmene||""))}}(e,t,n,20),n+=8}))},C=function(e,t){var n=9;t.forEach((function(t){!function(e,t,n,l){var c=n,d=l;if(t.busnumber){e.getRow(c).getCell(d).value=t.busnumber;var v=[];switch(t.drivers.length){case 1:v=[4];break;case 2:v=[2,6];break;case 3:v=[1,4,7];break;case 4:v=[1,3,5,7]}t.drivers.forEach((function(t,n){var l=new S.a(t);!function(e,t,n,l){var c=n,d=l;e.getRow(c).getCell(d+1).value=t.shortName,e.getRow(c).getCell(d+2).value=t.tabnumber;for(var v=t.statusesByDate({date:"".concat(o,"-").concat(r,"-01"),count:12,isShort:!0}),f=0;f<12;f++)e.getRow(c).getCell(d+4+f).value=v[f]}(e,l,c+v[n],d)}))}}(e,t,n,2),n+=8}))},n=t.buses,template=t.template,r=t.month,o="2019",c=(c=Array.from(n)).sort((function(a,b){return a.busnumber-b.busnumber})),d=new $.a.Workbook,e.next=9,d.xlsx.load(template);case 9:for((v=Math.ceil(c.length/4))%2==0&&v++,f=[],i=0;i<v;i++)for(f.push([]),m=0;m<4;m++)f[i].push(c[4*i+m]||{});for(f.unshift([{},{},{},{}]),h=f.length,w=d.getWorksheet("Page 1"),x=1;x<h;x++)(R=d.addWorksheet("Sheet")).model=Object.assign(w.model,{mergeCells:w.model.merges}),R.name="Page "+(1+x);for(k=0;k<h/2;k++)w=d.getWorksheet("Page "+(2*k+1)),C(w,f[k+1]),y(w,f[h-(k+1)]),w=d.getWorksheet("Page "+(2*k+2)),C(w,f[(h-k)%h]),y(w,f[k]);return e.next=20,d.xlsx.writeBuffer();case 20:return e.abrupt("return",e.sent);case 21:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),G={components:{AppDownload:C,MenuDatePicker:D.a},data:function(){return{file:null,isLoading:!1,renderer:J,month:"01",items:[{text:"Январь",value:"01"},{text:"Февраль",value:"02"},{text:"Март",value:"03"},{text:"Апрель",value:"04"},{text:"Май",value:"05"},{text:"Июнь",value:"06"},{text:"Июль",value:"07"},{text:"Август",value:"08"},{text:"Сентябрь",value:"09"},{text:"Октябрь",value:"10"},{text:"Ноябрь",value:"11"},{text:"Декабрь",value:"12"}]}},computed:{buses:function(){return this.$store.getters["buses/list"]},template:function(){return this.$store.getters["templates/template"]("templates/a3.xlsx")}},methods:{get_file:function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n,r=this,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]&&o[0],this.isLoading=!0,e.next=4,Promise.all([this.$store.dispatch("buses/readAll"),this.$store.dispatch("templates/download",{filename:"templates/a3.xlsx"})]);case 4:if(n=null,!t){e.next=9;break}n=this.template,e.next=12;break;case 9:return e.next=11,this.renderer.render({buses:this.buses,template:this.template,month:this.month});case 11:n=e.sent;case 12:d()(new Blob([n]),"Журнал A3 на ".concat(this.items.find((function(e){return e.value==r.month})).text,".xlsx")),this.isLoading=!1;case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),onFileChange:function(e){this.file=e},uploadFile:function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoading=!0,(t=new FormData).append("template",this.file),e.next=5,this.$axios.post("/api/templates/a3.xlsx",t,{headers:{enctype:"multipart/form-data"}});case 5:n=e.sent,n.data,this.isLoading=!1;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}},H=Object(f.a)(G,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("app-download",{attrs:{title:"A3",loading:e.isLoading},on:{download:e.get_file}},[n("v-select",{attrs:{items:e.items,label:"Месяц"},model:{value:e.month,callback:function(t){e.month=t},expression:"month"}}),e._v(" "),n("v-file-input",{attrs:{label:"Шаблон"},on:{change:e.onFileChange}}),e._v(" "),n("v-layout",[n("v-row",[n("v-col",{staticClass:"text-center",attrs:{cols:"12",md:"6"}},[n("v-btn",{attrs:{rounded:"",color:"green",dark:""},on:{click:e.uploadFile}},[e._v("Загрузить")])],1),e._v(" "),n("v-col",{staticClass:"text-center",attrs:{cols:"12",md:"6"}},[n("v-btn",{attrs:{rounded:"",color:"green",dark:""},on:{click:function(t){return e.get_file(!0)}}},[e._v("Скачать")])],1)],1)],1)],1)}),[],!1,null,null,null),K=H.exports;h()(H,{VBtn:w.a,VCol:B.a,VFileInput:F.a,VLayout:W.a,VRow:T.a,VSelect:I.a});var Q=function(){function e(){Object(O.a)(this,e)}var t;return Object(j.a)(e,null,[{key:"render",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,template,r,o,l,c,d,v,f,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.drivers,template=t.template,r=t.month,o=new $.a.Workbook,e.next=4,o.xlsx.load(template);case 4:return l=Array.from(n).sort((function(a,b){return a.tabnumber-b.tabnumber})),c=o.getWorksheet("main"),d=["январе","феврале","марте","апреле","мае","июне","июле","фвгусте","сентябре","октябре","ноябре","декабре"],c.getRow(1).getCell(1).value='Администрация Филиала "Юго-Западный", в лице директора  Р.А. Езохова, предлагает нижеперечисленным водителям 13-ой автоколонны выполнять сверхурочную работу за пределами установленной продолжительности рабочего времени (баланса), а так же работу в выходные, праздничные дни в '.concat(d[+r-1]," 2019  года."),v=3,f=0,m=0,l.forEach((function(e){f=2+4*m,c.getRow(v).getCell(f).value=e.tabnumber,f=3+4*m,c.getRow(v).getCell(f).value=e.shortName,51==++v&&(v=3,m++)})),e.next=14,o.xlsx.writeBuffer();case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),U={components:{AppDownload:C,MenuDatePicker:D.a},data:function(){return{file:null,isLoading:!1,renderer:Q,month:"01",items:[{text:"Январь",value:"01"},{text:"Февраль",value:"02"},{text:"Март",value:"03"},{text:"Апрель",value:"04"},{text:"Май",value:"05"},{text:"Июнь",value:"06"},{text:"Июль",value:"07"},{text:"Август",value:"08"},{text:"Сентябрь",value:"09"},{text:"Октябрь",value:"10"},{text:"Ноябрь",value:"11"},{text:"Декабрь",value:"12"}]}},computed:{drivers:function(){return this.$store.getters["drivers/list"]},template:function(){return this.$store.getters["templates/template"]("templates/agreement.xlsx")}},methods:{get_file:function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n,r=this,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]&&o[0],this.isLoading=!0,e.next=4,Promise.all([this.$store.dispatch("drivers/readAll"),this.$store.dispatch("templates/download",{filename:"templates/agreement.xlsx"})]);case 4:if(n=null,!t){e.next=9;break}n=this.template,e.next=12;break;case 9:return e.next=11,this.renderer.render({drivers:this.drivers,template:this.template,month:this.month});case 11:n=e.sent;case 12:d()(new Blob([n]),"Согласие за ".concat(this.items.find((function(e){return e.value==r.month})).text,".xlsx")),this.isLoading=!1;case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),onFileChange:function(e){this.file=e},uploadFile:function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoading=!0,(t=new FormData).append("template",this.file),e.next=5,this.$axios.post("/api/templates/agreement.xlsx",t,{headers:{enctype:"multipart/form-data"}});case 5:n=e.sent,n.data,this.isLoading=!1;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}},X=Object(f.a)(U,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("app-download",{attrs:{title:"Согласие",loading:e.isLoading},on:{download:e.get_file}},[n("v-select",{attrs:{items:e.items,label:"Месяц"},model:{value:e.month,callback:function(t){e.month=t},expression:"month"}}),e._v(" "),n("v-file-input",{attrs:{label:"Шаблон"},on:{change:e.onFileChange}}),e._v(" "),n("v-layout",[n("v-row",[n("v-col",{staticClass:"text-center",attrs:{cols:"12",md:"6"}},[n("v-btn",{attrs:{rounded:"",color:"green",dark:""},on:{click:e.uploadFile}},[e._v("Загрузить")])],1),e._v(" "),n("v-col",{staticClass:"text-center",attrs:{cols:"12",md:"6"}},[n("v-btn",{attrs:{rounded:"",color:"green",dark:""},on:{click:function(t){return e.get_file(!0)}}},[e._v("Скачать")])],1)],1)],1)],1)}),[],!1,null,null,null),Z=X.exports;h()(X,{VBtn:w.a,VCol:B.a,VFileInput:F.a,VLayout:W.a,VRow:T.a,VSelect:I.a});n(10),n(8),n(9);var ee=n(0),te=n(170),ne=n(186),re=function(){function e(){Object(O.a)(this,e)}var t;return Object(j.a)(e,null,[{key:"render",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,r,o,l,c,d,v,i,f,m,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.outfitItems,r=t.routes,o=t.drivers,l=t.buses,c=t.date,d=new $.a.Workbook,v=d.addWorksheet("Main"),i=0;i<11;i++)(f=v.getColumn(i+1)).width=11,f.style={font:{size:14}};return m=Array.from(r).sort((function(a,b){return a.title!=b.title?a.title<b.title?-1:1:0})),v.addRow(["Маршрут","Выход","Автобус","Первая","Вторая","Полный"]),h=2,m.forEach((function(e){e.hasActiveWays(c)&&(v.getRow(h++).getCell(1).value=e.title,Array.from(e.ways).sort((function(a,b){return a.title!=b.title?a.title<b.title?-1:1:0})).forEach((function(e){if(new ne.a(e).isActive(c)){var t=n.find((function(t){return t.wayId==e._id}));v.getRow(h).getCell(2).value=e.title;var r=l.find((function(e){return e._id==t.bus}));r&&(v.getRow(h).getCell(3).value=r.busnumber);var d=o.find((function(e){return e._id==t.firstSmene}));d&&(v.getRow(h).getCell(4).value=d.tabnumber),(d=o.find((function(e){return e._id==t.secondSmene})))&&(v.getRow(h).getCell(5).value=d.tabnumber),(d=o.find((function(e){return e._id==t.allDay})))&&(v.getRow(h).getCell(6).value=d.tabnumber),h++}})))})),e.next=10,d.xlsx.writeBuffer();case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}();function ae(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}var oe={components:{AppDownload:C,MenuDatePicker:D.a},data:function(){return{date:l()().format("YYYY-MM-DD"),isLoading:!1,renderer:re}},computed:function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ae(source,!0).forEach((function(t){Object(ee.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):ae(source).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},Object(te.b)({buses:"buses/list",drivers:"drivers/list",routes:"routes/list",outfitItems:"outfit/items"})),methods:{get_file:function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoading=!0,e.next=3,Promise.all([this.$store.dispatch("buses/readAll"),this.$store.dispatch("drivers/readAll"),this.$store.dispatch("routes/readAll"),this.$store.dispatch("outfit/readByDate",{date:this.date})]);case 3:return e.next=5,this.renderer.render({outfitItems:this.outfitItems,routes:this.routes,drivers:this.drivers,buses:this.buses,date:this.date});case 5:t=e.sent,d()(new Blob([t]),"Наряд на ".concat(l()(this.date).format("DD-MM-YY"),".xlsx")),this.isLoading=!1;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}},se={transition:"fade",components:{DownloadReport:P,DownloadA4:z,DownloadA3:K,DownloadAgreement:Z,DownloadOutfit:Object(f.a)(oe,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("app-download",{attrs:{title:"Наряд",loading:e.isLoading},on:{download:e.get_file}},[n("menu-date-picker",{model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1)}),[],!1,null,null,null).exports}},le=Object(f.a)(se,(function(){var e=this.$createElement,t=this._self._c||e;return t("v-layout",[t("v-row",[t("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[t("download-a4")],1),this._v(" "),t("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[t("download-a3")],1),this._v(" "),t("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[t("download-agreement")],1),this._v(" "),t("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[t("download-report")],1),this._v(" "),t("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[t("download-outfit")],1)],1)],1)}),[],!1,null,null,null);t.default=le.exports;h()(le,{VCol:B.a,VLayout:W.a,VRow:T.a})}}]);