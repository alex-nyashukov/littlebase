(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{567:function(t,e,r){"use strict";var n={props:["item","left","right"]},o=r(24),c=r(25),l=r.n(c),v=r(166),d=r(558),_=r(557),h=r(169),f=r(171),m=r(568),component=Object(o.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-tooltip",{attrs:{"content-class":"pa-0",left:t.left,right:t.right,"open-on-hover":"","offset-x":"",disabled:t.$vuetify.breakpoint.xs},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[r("v-chip",t._g({},n),[t._v(t._s(t.item.tabnumber))])]}}])},[t._v(" "),r("v-card",{attrs:{"min-width":"500"}},[r("v-card-text",[r("v-input",{attrs:{messages:[t.item.phone]},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("v-avatar",{attrs:{size:"100",color:"grey"}},[t.item.image?r("img",{attrs:{src:t.item.image}}):t._e()])]},proxy:!0}])},[t._v("\n        "+t._s(t.item.name)+"\n      ")])],1)],1)],1)}),[],!1,null,null,null);e.a=component.exports;l()(component,{VAvatar:v.a,VCard:d.a,VCardText:_.b,VChip:h.a,VInput:f.a,VTooltip:m.a})},600:function(t,e,r){"use strict";r.r(e);var n=r(2),o=r.n(n),c=(r(27),r(29),r(20)),l=r(181),v=function t(e,r){var n=this;Object(c.a)(this,t),this.errors=[],this.workTable=[],this.driverReserveCount=0,this.driverReserveTable=[],this.busReserve=[],this.outDrivers={"Выходной":[],"Больничный":[],"Отпуск":[]},this.outBuses={"Ремонт":[],"СВАРЗ":[]},r.forEach((function(t){var r={"Рабочий":[],"Первая см.":[],"Вторая см.":[]},o=0;t.drivers.forEach((function(t){var c=(t=new l.a(t)).statusesByDate({date:e,count:1,isShort:!1,withExceptions:!0})[0].status;c?["Рабочий","Первая см.","Вторая см."].includes(c)?(o++,r[c].push(t)):n.outDrivers[c].push(t):n.errors.push("У водителя ".concat(t.tabnumber," нет статуса"))})),["Ремонт","СВАРЗ","Долгостой"].includes(t.status)?("Долгостой"==t.status?n.outBuses["Ремонт"].push(t):n.outBuses[t.status].push(t),0!==o&&(n.driverReserveCount+=o,n.driverReserveTable.push(r))):0===o?n.busReserve.push(t):(r["Автобус"]=t,n.workTable.push(r))}))},d={transition:"fade",components:{DriverMiniCard:r(567).a},data:function(){return{snackbar:{isOpen:!1,queye:[],current:0},date:o()().format("YYYY-MM-DD"),menu:!1,headers:[]}},computed:{formattedDate:function(){return this.date?o()(this.date).format("DD/MM/YYYY"):""},report:function(){var t=this;this.snackbar.isOpen=!1;var e=new v(this.date,this.buses);return e.errors.length>0&&setTimeout((function(){t.snackbar.current=0,t.snackbar.queye=e.errors,t.snackbar.isOpen=!0,console.log(t.snackbar)}),300),e},buses:function(){return this.$store.getters["buses/list"]}},methods:{swapSnackbar:function(){this.snackbar.queye[this.snackbar.current+1]?this.snackbar.current++:(this.snackbar.current=0,this.snackbar.isOpen=!1)},nextDay:function(){this.date=o()(this.date).add(1,"d").format("YYYY-MM-DD")},update:function(){this.$store.dispatch("buses/readAll")},prevDay:function(){this.date=o()(this.date).subtract(1,"d").format("YYYY-MM-DD")}},mounted:function(){this.$store.dispatch("buses/readAll")}},_=r(24),h=r(25),f=r.n(h),m=r(106),k=r(558),y=r(557),w=r(169),x=r(595),C=r(552),D=r(547),V=r(132),Y=r(549),T=r(170),R=r(596),M=r(569),O=r(597),S=r(76),component=Object(_.a)(d,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-card",[r("v-snackbar",{attrs:{color:"red","multi-line":"",right:"",timeout:6e4,top:""},model:{value:t.snackbar.isOpen,callback:function(e){t.$set(t.snackbar,"isOpen",e)},expression:"snackbar.isOpen"}},[t._v("\n    "+t._s(t.snackbar.queye[t.snackbar.current])+"\n    "),r("v-btn",{attrs:{dark:"",text:""},on:{click:t.swapSnackbar}},[t._v("Close")])],1),t._v(" "),r("v-card-title",[r("v-flex",{attrs:{xs12:"",sm7:"",md4:""}},[r("v-layout",{attrs:{"align-center":"","justify-end":""}},[r("v-menu",{attrs:{"close-on-content-click":!1,"max-width":"290"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[r("v-text-field",t._g({staticClass:"desable-shadow mr-4",staticStyle:{"box-shadow":"none"},attrs:{flat:"",solo:"","hide-details":"",value:t.formattedDate,label:"Date",readonly:""}},n))]}}]),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[t._v(" "),r("v-date-picker",{attrs:{"no-title":""},on:{change:function(e){t.menu=!1}},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1),t._v(" "),r("v-btn",{attrs:{color:"white",elevation:"1",fab:"",small:""},on:{click:t.prevDay}},[r("v-icon",{attrs:{color:"grey darken-1"}},[t._v("fa-chevron-left")])],1),t._v(" "),r("v-btn",{staticClass:"ml-3",attrs:{color:"white",elevation:"1",fab:"",small:""},on:{click:t.update}},[r("v-icon",{attrs:{color:"grey darken-1"}},[t._v("fa-redo-alt")])],1),t._v(" "),r("v-btn",{staticClass:"ml-3",attrs:{color:"white",elevation:"1",fab:"",small:""},on:{click:t.nextDay}},[r("v-icon",{attrs:{color:"grey darken-1"}},[t._v("fa-chevron-right")])],1)],1)],1)],1),t._v(" "),r("v-card-text",{staticClass:"mt-3"},[r("v-row",[r("v-col",[r("h1",[t._v("Автобусы")]),t._v(" "),r("h2",{staticClass:"pt-2"},[t._v("Резерв ("+t._s(t.report.busReserve.length)+")")]),t._v(" "),t._l(t.report.busReserve.sort((function(a,b){return a.busnumber-b.busnumber})),(function(e){return r("v-chip",{key:e._id},[t._v(t._s(e.busnumber))])})),t._v(" "),t._l(t.report.outBuses,(function(e,n){return[r("h2",{key:n,staticClass:"pt-2"},[t._v(t._s(n)+" ("+t._s(e.length)+")")]),t._v(" "),t._l(e.sort((function(a,b){return a.busnumber-b.busnumber})),(function(e){return r("v-chip",{key:e._id},[t._v(t._s(e.busnumber))])}))]}))],2),t._v(" "),r("v-col",[r("h1",[t._v("Водители")]),t._v(" "),r("h2",{staticClass:"pt-2"},[t._v("Резерв ("+t._s(t.report.driverReserveCount)+")")]),t._v(" "),r("v-simple-table",[r("thead",[r("tr",[r("th",[t._v("Первая см.")]),t._v(" "),r("th",[t._v("Вторая см.")]),t._v(" "),r("th",[t._v("Полный день")])])]),t._v(" "),r("tbody",t._l(t.report.driverReserveTable,(function(e,i){return r("tr",{key:i},[r("td",t._l(e["Первая см."],(function(t){return r("driver-mini-card",{key:t._id,attrs:{item:t,left:""}})})),1),t._v(" "),r("td",t._l(e["Вторая см."],(function(t){return r("driver-mini-card",{key:t._id,attrs:{item:t,left:""}})})),1),t._v(" "),r("td",t._l(e["Рабочий"],(function(t){return r("driver-mini-card",{key:t._id,attrs:{item:t,left:""}})})),1)])})),0)]),t._v(" "),t._l(t.report.outDrivers,(function(e,n){return[r("h2",{key:n,staticClass:"pt-2"},[t._v(t._s(n)+" ("+t._s(e.length)+")")]),t._v(" "),t._l(e.sort((function(a,b){return a.tabnumber-b.tabnumber})),(function(t){return r("driver-mini-card",{key:t._id,attrs:{item:t,left:""}})}))]}))],2)],1),t._v(" "),r("h1",[t._v("Рабочие")]),t._v(" "),r("v-simple-table",[r("thead",[r("tr",[r("th",[t._v("Автобус")]),t._v(" "),r("th",[t._v("Первая см.")]),t._v(" "),r("th",[t._v("Вторая см.")]),t._v(" "),r("th",[t._v("Полный день")])])]),t._v(" "),r("tbody",t._l(t.report.workTable,(function(e){return r("tr",{key:e["Автобус"]._id},[r("td",[r("v-chip",[t._v(t._s(e["Автобус"].busnumber))])],1),t._v(" "),r("td",t._l(e["Первая см."],(function(t){return r("driver-mini-card",{key:t._id,attrs:{item:t,left:""}})})),1),t._v(" "),r("td",t._l(e["Вторая см."],(function(t){return r("driver-mini-card",{key:t._id,attrs:{item:t,left:""}})})),1),t._v(" "),r("td",t._l(e["Рабочий"],(function(t){return r("driver-mini-card",{key:t._id,attrs:{item:t,left:""}})})),1)])})),0)])],1)],1)}),[],!1,null,null,null);e.default=component.exports;f()(component,{VBtn:m.a,VCard:k.a,VCardText:y.b,VCardTitle:y.c,VChip:w.a,VCol:x.a,VDatePicker:C.a,VFlex:D.a,VIcon:V.a,VLayout:Y.a,VMenu:T.a,VRow:R.a,VSimpleTable:M.a,VSnackbar:O.a,VTextField:S.a})}}]);